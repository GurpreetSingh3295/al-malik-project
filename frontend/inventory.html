<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inventory | Al-Malik</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark">
  <div class="container">
    <span class="navbar-brand fw-bold">Al-<span class="text-warning">Malik</span> Inventory</span>
    <a class="btn btn-warning" href="/auth/logout">Logout</a>
  </div>
</nav>

<div class="container mt-4">
  <h2 class="mb-4">Available Vehicles</h2>

  <table class="table table-hover table-bordered">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Make</th>
        <th>Model</th>
        <th>Year</th>
        <th>Price (AED)</th>
        <th>Status</th>
        <th>Fuel</th>
        <th>Transmission</th>
        <th>Color</th>
      </tr>
    </thead>
    <tbody id="inventoryTableBody">
      <!-- Data loads here -->
    </tbody>
  </table>
</div>

<script>
async function loadInventory() {
  try {
    const res = await fetch("/api/inventory", { credentials: "include" });

    // üö® If not logged in ‚Üí redirect
    if (res.status === 401) {
      window.location.href = "/login.html";
      return;
    }

    const data = await res.json();
    if (!data.ok) {
      console.error("Server error:", data.error);
      return;
    }

    const tbody = document.getElementById("inventoryTableBody");
    tbody.innerHTML = "";

    data.cars.forEach(car => {
      tbody.innerHTML += `
        <tr>
          <td>${car.id}</td>
          <td>${car.make} ${car.model}</td>
          <td>${car.year}</td>
          <td>${car.price}</td>
          <td>${car.status}</td>
          <td>${car.mileage || "N/A"}</td>
          <td>${car.fuelType || ""}</td>
          <td>${car.transmission || ""}</td>
        </tr>
      `;
    });

  } catch (error) {
    console.error("‚ùå Inventory Load Error:", error);
  }
}

loadInventory();

</script>


</body>
</html>
